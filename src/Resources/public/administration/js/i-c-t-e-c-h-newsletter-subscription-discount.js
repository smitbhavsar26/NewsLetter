!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/bundles/ictechnewslettersubscriptiondiscount/",n(n.s="T88Z")}({T88Z:function(e,t,n){"use strict";n.r(t);var o=Shopware,i=o.Component,r=o.Mixin,s=o.Defaults,l=Shopware.Data.Criteria;i.register("newsletter-promotion-configuration",{template:'{% block newsletter_prmotion_configuration %}\n    <sw-page class="newsletter-promotion-configuration">\n        {% block newsletter_prmotion_configuration_header %}\n            <template #smart-bar-header>\n                <h2>\n                    {{ $tc(\'sw-settings.index.title\') }}\n                    <sw-icon name="small-arrow-medium-right" small></sw-icon>\n                    {{ $tc(\'newsletter-promotion.header\') }}\n                </h2>\n            </template>\n        {% endblock %}\n\n        {% block newsletter_prmotion_configuration_actions %}\n            <template #smart-bar-actions>\n                {% block newsletter_prmotion_configuration_actions_save %}\n                    <sw-button-process v-model="isSaveSuccessful"\n                                       class="sw-settings-login-registration__save-action"\n                                       variant="primary"\n                                       :isLoading="isLoading"\n                                       :disabled="isLoading || !acl.can(\'newsletter.editor\')"\n                                       @click="onSave">\n                        {{ $tc(\'global.default.save\') }}\n                    </sw-button-process>\n                {% endblock %}\n            </template>\n        {% endblock %}\n\n        {% block newsletter_prmotion_configuration_content %}\n            <template #content>\n                {% block newsletter_prmotion_configuration_content_card %}\n                    <sw-card-view>\n                        {% block newsletter_prmotion_configuration_content_card_channel_config %}\n                            <sw-sales-channel-config\n                                v-model="config"\n                                ref="configComponent"\n                                domain="newsletter.settings"\n                            >\n                                {% block newsletter_prmotion_configuration_content_card_channel_config_sales_channel %}\n                                    <template #select="{ onInput, selectedSalesChannelId }">\n                                        <sw-card :title="$tc(\'global.entities.sales_channel\', 2)">\n                                            {% block biller_configuration_content_card_channel_config_sales_channel_card_title %}\n                                                <sw-single-select v-model="selectedSalesChannelId"\n                                                                  labelProperty="translated.name"\n                                                                  valueProperty="id"\n                                                                  :isLoading="isLoading"\n                                                                  :options="salesChannels"\n                                                                  :disabled="!acl.can(\'newsletter.editor\')"\n                                                                  @change="onInput">\n                                                </sw-single-select>\n                                            {% endblock %}\n                                        </sw-card>\n                                    </template>\n                                {% endblock %}\n\n                                {% block newsletter_prmotion_configuration_content_card_channel_config_cards %}\n                                <template #content="{ actualConfigData, allConfigs, selectedSalesChannelId }">\n                                    <div v-if="actualConfigData">\n                                        <sw-card :title="$tc(\'newsletter-promotion.general.generalConfig\')">\n                                            <sw-container>\n\n                                                <div class="switch-field">\n                                                    <sw-inherit-wrapper v-model="actualConfigData[\'newsletter.settings.activeSwitch\']"\n                                                                        :inheritedValue="selectedSalesChannelId === null ? null : allConfigs[\'null\'][\'newsletter.settings.activeSwitch\']"\n                                                                        :customInheritationCheckFunction="checkBoolFieldInheritance">\n                                                        <template #content="props">\n                                                            <sw-switch-field name="newsletter.settings.activeSwitch"\n                                                                             :mapInheritance="props"\n                                                                             :label="$tc(\'newsletter-promotion.general.activeSwitch\')"\n                                                                             :disabled="props.isInherited || !acl.can(\'newsletter.editor\')"\n                                                                             :value="props.currentValue"\n                                                                             @change="props.updateCurrentValue">\n                                                            </sw-switch-field>\n                                                        </template>\n                                                    </sw-inherit-wrapper>\n                                                </div>\n\n                                                <div class="text-field">\n                                                    <sw-inherit-wrapper v-model="actualConfigData[\'newsletter.settings.promotionTitle\']"\n                                                                        :inheritedValue="selectedSalesChannelId === null ? null : allConfigs[\'null\'][\'newsletter.settings.promotionTitle\']"\n                                                                        :customInheritationCheckFunction="checkTextFieldInheritance">\n                                                        <template #content="props">\n                                                            <sw-text-field name="newsletter.settings.promotionTitle"\n                                                                           validation="required"\n                                                                           :mapInheritance="props"\n                                                                           :label="$tc(\'newsletter-promotion.promotion.promotionTitle\')"\n                                                                           :helpText="$tc(\'newsletter-promotion.promotion.titleHint\')"\n                                                                           :disabled="props.isInherited || !acl.can(\'newsletter.editor\')"\n                                                                           :value="props.currentValue"\n                                                                           @change="props.updateCurrentValue">\n                                                            </sw-text-field>\n                                                        </template>\n                                                    </sw-inherit-wrapper>\n                                                </div>\n\n                                                <div class="textarea-field">\n                                                    <sw-inherit-wrapper v-model="actualConfigData[\'newsletter.settings.description\']"\n                                                                        :inheritedValue="selectedSalesChannelId === null ? null : allConfigs[\'null\'][\'newsletter.settings.description\']"\n                                                                        :customInheritationCheckFunction="checkTextFieldInheritance">\n                                                        <template #content="props">\n                                                            <sw-textarea-field name="newsletter.settings.description"\n                                                                               validation="required"\n                                                                           :mapInheritance="props"\n                                                                           :label="$tc(\'newsletter-promotion.promotion.description\')"\n                                                                           :helpText="$tc(\'newsletter-promotion.promotion.descriptionHint\')"\n                                                                           :disabled="props.isInherited || !acl.can(\'newsletter.editor\')"\n                                                                           :value="props.currentValue"\n                                                                           @change="props.updateCurrentValue">\n                                                            </sw-textarea-field>\n                                                        </template>\n                                                    </sw-inherit-wrapper>\n                                                </div>\n\n                                                <div class="text-field">\n                                                    <sw-inherit-wrapper v-model="actualConfigData[\'newsletter.settings.promoCode\']"\n                                                                        :inheritedValue="selectedSalesChannelId === null ? null : allConfigs[\'null\'][\'newsletter.settings.promoCode\']"\n                                                                        :customInheritationCheckFunction="checkTextFieldInheritance"\n                                                                        :label="$tc(\'newsletter-promotion.promotion.promoCode\')">\n                                                        <template #content="props">\n                                                            <sw-single-select name="newsletter.settings.promoCode"\n                                                                              labelProperty="name"\n                                                                              valueProperty="id"\n                                                                              :options="promoCodeOptions"\n                                                                              :isInherited="props.isInherited"\n                                                                              :disabled="props.isInherited || !acl.can(\'newsletter.editor\')"\n                                                                              :value="props.currentValue"\n                                                                              @change="props.updateCurrentValue">\n                                                            </sw-single-select>\n                                                        </template>\n                                                    </sw-inherit-wrapper>\n                                                </div>\n                                            </sw-container>\n                                        </sw-card>\n                                    </div>\n                                </template>\n                                {% endblock %}\n                            </sw-sales-channel-config>\n                        {% endblock %}\n                    </sw-card-view>\n                {% endblock %}\n            </template>\n        {% endblock %}\n    </sw-page>\n{% endblock %}\n',inject:["repositoryFactory","configService","acl"],mixins:[r.getByName("notification")],data:function(){return{isLoading:!1,isSaveSuccessful:!1,config:null,salesChannels:[],promoCodeOptions:[]}},computed:{salesChannelRepository:function(){return this.repositoryFactory.create("sales_channel")},promotionRepository:function(){return this.repositoryFactory.create("promotion")}},created:function(){this.createdComponent(),this.getPromotionProperties()},methods:{createdComponent:function(){var e=this;this.isLoading=!0;var t=new l;t.addFilter(l.equalsAny("typeId",[s.storefrontSalesChannelTypeId,s.apiSalesChannelTypeId])),this.salesChannelRepository.search(t,Shopware.Context.api).then((function(t){t.add({id:null,translated:{name:e.$tc("sw-sales-channel-switch.labelDefaultOption")}}),e.salesChannels=t})).finally((function(){e.isLoading=!1}))},onSave:function(){var e=this,t=this.$refs.configComponent.selectedSalesChannelId;if(null==t){if(!this.$refs.configComponent.allConfigs[t]["newsletter.settings.promotionTitle"])return void this.createNotificationError({title:this.$tc("global.default.error"),message:this.$tc("newsletter-promotion.save.errorTitleSalesChannel")});if(!this.$refs.configComponent.allConfigs[t]["newsletter.settings.description"])return void this.createNotificationError({title:this.$tc("global.default.error"),message:this.$tc("newsletter-promotion.save.errorTitleDescription")});if(!this.$refs.configComponent.allConfigs[t]["newsletter.settings.promoCode"])return void this.createNotificationError({title:this.$tc("global.default.error"),message:this.$tc("newsletter-promotion.save.errorTitlePromoCode")})}this.isLoading=!0,this.$refs.configComponent.save().then((function(){e.isSaveSuccessful=!0,e.createNotificationSuccess({title:e.$tc("newsletter-promotion.action.titleSaveSuccess"),message:e.$tc("newsletter-promotion.action.messageSaveSuccess")})})).finally((function(){e.isLoading=!1}))},checkTextFieldInheritance:function(e){return"string"!=typeof e||e.length<=0},checkBoolFieldInheritance:function(e){return"boolean"!=typeof e},getPromotionProperties:function(){var e=this,t=new l;t.addAssociation("personaRules"),t.addFilter(l.equals("validFrom",null)),t.addFilter(l.equals("validUntil",null)),t.addFilter(l.equals("maxRedemptionsPerCustomer",1)),t.addFilter(l.equals("exclusive",!1)),t.addFilter(l.equals("preventCombination",!0)),t.addFilter(l.not("and",[l.equals("code",null)])),t.addFilter(l.not("and",[l.equals("salesChannels.salesChannelId",null)])),t.addFilter(l.equals("personaRules.id",null)),t.addFilter(l.equals("orderRules.id",null)),t.addFilter(l.equals("useSetGroups",!1)),t.addFilter(l.equals("cartRules.id",null)),t.addFilter(l.equals("discounts.scope","cart")),t.addFilter(l.equals("discounts.considerAdvancedRules",!1)),t.addFilter(l.not("and",[l.equals("discounts.type","fixed_unit")])),this.promotionRepository.search(t,Shopware.Context.api).then((function(t){return t.forEach((function(t){e.promoCodeOptions.push(t)})),e.promoCodeOptions}))}}});var a=n("wp61"),c=n("altR"),p=n("dnDy");Shopware.Module.register("newsletter-promotion",{type:"plugin",name:"newsletter-promotion.general.mainMenuItemGeneral",title:"newsletter-promotion.general.mainMenuItemGeneral",description:"newsletter-promotion.general.descriptionTextModule",color:"#9AA8B5",icon:"default-communication-inbox",favicon:"icon-module-settings.png",snippets:{"de-DE":a,"en-GB":c,"nl-NL":p},routes:{index:{component:"newsletter-promotion-configuration",path:"index",meta:{parentPath:"sw.settings.index"}}},settingsItem:{name:"newsletter-promotion",to:"newsletter.promotion.index",label:"newsletter-promotion.general.mainMenuItemGeneral",group:"plugins",icon:"default-communication-inbox"}})},altR:function(e){e.exports=JSON.parse('{"newsletter-promotion":{"header":"NewsLetter Promotion","general":{"generalConfig":"General Configuration","activeSwitch":"Activate Plugin","mainMenuItemGeneral":"NewsLetter Promotion","descriptionTextModule":"Manage NewsLetter Promotion configuration here"},"action":{"buttonSaveText":"Save","titleSaveSuccess":"Success","messageSaveSuccess":"Details saved successfully"},"save":{"errorTitle":"Configuration could not save","errorTitleSalesChannel":"Please Fill Newsletter pop-up title","errorTitleDescription":"Please Fill Newsletter Description","errorTitlePromoCode":"Please Select Newsletter PromoCode","success":"Configuration is saved"},"promotion":{"promotionTitle":"Newsletter pop-up title","titleHint":"Use <a href=\'https://prnt.sc/1AbIOwfOCndP\'>\\"%discount%\\"</a>  to display the promotion value.","description":"Newsletter pop-up description","descriptionHint":"Use <a href=\'https://prnt.sc/1AbIOwfOCndP\'>\\"%discount%\\"</a> to display the promotion value.","promoCode":"Select Promotion for Newsletter Subscription on Cart/Checkout page"}}}')},dnDy:function(e){e.exports=JSON.parse('{"newsletter-promotion":{"header":"nieuwsbrief-promotie","general":{"generalConfig":"Algemene Configuratie","activeSwitch":"Activeer Plugin","mainMenuItemGeneral":"Nieuwsbrief Promotie","descriptionTextModule":"Beheer hier de configuratie van NewsLetter Promotion"},"action":{"buttonSaveText":"Sla","titleSaveSuccess":"Succes","messageSaveSuccess":"Details succesvol opgeslage"},"save":{"errorTitle":"Configuratie kan niet worden opgeslagen","errorTitleSalesChannel":"Vul de titel van de pop-up van de nieuwsbrief in","errorTitleDescription":"Vul de nieuwsbriefbeschrijving in","errorTitlePromoCode":"Selecteer Nieuwsbrief PromoCode","success":"Configuratie wordt opgeslagen"},"promotion":{"promotionTitle":"Nieuwsbrief pop-up titel","titleHint":"Gebruik \\"%discount%\\" om de promotiewaarde weer te geven.","description":"Nieuwsbrief pop-up beschrijving","descriptionHint":"Gebruik \\"%discount%\\" oom de promotiewaarde weer te geven.","promoCode":"Selecteer Promotie voor nieuwsbriefabonnement op winkelwagen/afrekenpagina"}}}')},wp61:function(e){e.exports=JSON.parse('{"newsletter-promotion":{"header":"Newsletter-Promotion","general":{"generalConfig":"Allgemeine Konfiguration","mainMenuItemGeneral":"Newsletter-Aktion","activeSwitch":"Plugin aktivieren","descriptionTextModule":"Verwalten Sie hier die Konfiguration der Newsletter-Aktion"},"action":{"buttonSaveText":"Speichern","titleSaveSuccess":"Erfolgreich","messageSaveSuccess":"Details erfolgreich gespeichert"},"save":{"errorTitle":"Konfiguration konnte nicht gespeichert werden","errorTitleSalesChannel":"Bitte füllen Sie den Popup-Titel des Newsletters aus","errorTitleDescription":"Bitte füllen Sie die Newsletter-Beschreibung aus","errorTitlePromoCode":"Bitte Newsletter PromoCode auswählen","success":"Konfiguration wird gespeichert"},"promotion":{"promotionTitle":"Newsletter-Popup-Titel","titleHint":"Benutzer \\"%discount%\\" um den Aktionswert anzuzeigen.","description":"Newsletter-Popup-Beschreibung","descriptionHint":"Benutzer \\"%discount%\\" um den Aktionswert anzuzeigen.","promoCode":"Wählen Sie Aktion für das Newsletter-Abonnement auf der Warenkorb-/Kasse-Seite"}}}')}});